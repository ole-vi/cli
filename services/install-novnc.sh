#!/bin/bash

function install {
  # create service directory
  mkdir -p /srv/novnc

  # create yml(s)
  cat << EOF > /srv/novnc/novnc.yml
version: '3'
services:
  novnc:
    image: treehouses/novnc
    ports:
    - "6080:6080"
EOF

  # create .env with default values
  # {
  #  echo "EXAMPLE_VAR="
  # } > /srv/<service>/.env

  # add autorun
  cat << EOF > /srv/novnc/autorun
novnc_autorun=true

if [ "$novnc_autorun" = true ]; then
  treehouses services novnc up
fi


EOF
}

# environment var
function uses_env {
  echo false
}

# add supported arch(es)
function supported_arms {
  echo "armv7l"
  echo "armv6l"
  echo "x86_64"
}

# add port(s)
function get_ports {
  echo "6080"
}

# add size (in MB)
function get_size {
  echo "133"
}

# add info
function get_info {
  echo "https://github.com/treehouses/novnc"
  echo
  echo "\"noVNC is both a HTML VNC client JavaScript library and an application built on top of that library. noVNC runs well in any modern browser including mobile browsers (iOS and Android).\""
}

# add svg icon
function get_icon {
  cat <<EOF
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 34.436 21.154"><path fill="#f5ed08" d="M5.52 20.678c-.216-.22-.462-.567-.547-.768-.084-.2-.232-.478-.33-.615-.094-.137-.337-.556-.533-.933-.2-.376-.58-1.083-.847-1.57-.775-1.414-1.22-2.238-1.606-2.972-.196-.377-.442-.803-.545-.948-.103-.145-.185-.3-.185-.344 0-.044-.188-.404-.42-.798-.594-1.014-.6-1.005.475-1.005 1.238 0 1.227-.008 2.37 2.053.214.386.6 1.08.862 1.54.262.463.563 1.01.674 1.215.11.206.378.675.595 1.043.217.37.394.702.394.74 0 .106.41.69.484.69.07 0 .19-.2 1.11-1.866.24-.434.62-1.106.84-1.492.22-.383.52-.913.66-1.175.14-.26.43-.772.65-1.135.21-.362.39-.698.39-.746 0-.71 2.27-1.33 2.48-.674.04.103.14.188.24.188.34 0 .27.177-1.03 2.522-.27.49-.68 1.244-.91 1.68-.23.437-.49.905-.59 1.043-.1.14-.18.3-.18.36s-.11.28-.24.49c-.13.21-.41.71-.62 1.1-1.61 3.03-1.38 2.77-2.37 2.79-.83.02-.83.02-1.22-.38zm8.35.347c-.038-.036-.067-.137-.067-.226 0-.1-.098-.19-.234-.22-.24-.06-.24-.06-.21-4.94.02-4.88.02-4.88.91-4.9.92-.03 1.48.34 2.44 1.61.12.15.31.39.44.53.6.65 3 3.39 3.73 4.25.57.68.56.73.59-3.02.02-3.36.02-3.36.84-3.39.68-.02.82 0 .87.12.03.08.16.19.28.23.22.08.22.08.2 5.01-.03 4.93-.03 4.93-.91 4.95-.89.02-.89.02-1.52-.7-.35-.4-.78-.87-.94-1.05-.17-.18-.7-.79-1.18-1.35-.48-.57-1.07-1.24-1.3-1.5-.24-.26-.64-.72-.89-1.03-.67-.79-1.04-1.164-1.16-1.164-.07 0-.11 1.024-.13 3.384-.03 3.387-.03 3.387-.87 3.41-.47.02-.87 0-.91-.04zm11.995-.006c-.346-.07-1.335-1.06-1.576-1.57-.22-.46-.22-.51-.22-3.83 0-5.19-.35-4.9 5.62-4.9 3.72 0 4.18.01 4.23.14.03.08.16.18.28.23.21.08.22.11.2.95-.03.86-.03.86-4 .91-3.97.05-3.97.05-3.97 2.89s0 2.84 3.71 2.87c3.71.02 3.71.02 3.8.24.05.12.17.24.28.27.19.05.19.1.17.92-.03.87-.03.87-4.18.88-2.29 0-4.25-.01-4.37-.03zM.477 8.46C.414 8.4.362 8.295.362 8.23s-.085-.164-.188-.22c-.184-.1-.187-.175-.163-4.04C.04.036.04.036 3.33.012 7.125-.015 6.94-.05 7.845.9c.665.698.656.63.62 4.6-.03 3.033-.03 3.033-.915 3.033-.85 0-.89-.01-.917-.21-.017-.114-.11-.252-.21-.304-.168-.1-.18-.25-.203-2.92-.024-2.82-.024-2.82-1.985-2.82-1.96 0-1.96 0-2.006 3.13-.05 3.12-.05 3.12-.85 3.15-.54.02-.83-.01-.91-.09zm10.165-.01c-.428-.138-1.312-.964-1.52-1.42-.15-.334-.17-.662-.17-3.035 0-4.08-.126-3.95 3.903-3.99 3.11-.033 3.112-.033 3.962.88.623.67.618.64.623 3.56.005 4.073-.053 4.132-4.105 4.116-1.414 0-2.507-.05-2.694-.11zm4.446-4.245c-.025-1.936-.025-1.936-1.94-1.936-1.912 0-1.912 0-1.938 1.81-.016 1-.005 1.87.02 1.93.033.09.49.12 1.962.12 1.92 0 1.92 0 1.892-1.94z"/><path fill="#007b00" d="M5.74 20.886c-.214-.306-.115-.362.64-.362.734 0 .96-.138 1.13-.684.035-.112.137-.307.226-.436.09-.128.34-.57.56-.98l.745-1.4.89-1.634c.3-.54.71-1.296.91-1.68.21-.386.41-.743.45-.794.04-.052.25-.43.47-.84.5-.948.53-.982.86-.982.44 0 .42.068-.94 2.518-.27.487-.68 1.244-.91 1.678-.23.434-.49.905-.59 1.04-.1.135-.17.296-.17.352 0 .058-.11.275-.24.486-.13.21-.41.704-.62 1.096-1.61 3.03-1.37 2.76-2.38 2.79-.78.025-.86.01-.99-.18zm8.098.062c-.124-.324.03-.424.66-.424.607 0 .607 0 .63-3.43.025-3.343.03-3.43.208-3.43.354 0 .378.255.328 3.88-.048 3.493-.048 3.493-.913 3.52-.7.02-.87 0-.92-.117zm7.858-.04c-.267-.295-.103-.384.696-.384.407 0 .75-.01.762-.023.01-.01.042-2.12.07-4.69.046-4.58.05-4.66.234-4.66.183 0 .185.07.185 4.95 0 4.95 0 4.95-.89 4.98-.793.03-.914.01-1.062-.16zm4.19.108c-.218-.055-.7-.382-.7-.475 0-.03 1.94-.05 4.307-.03 4.848.03 4.46.1 4.464-.75 0-.51.013-.54.212-.51.2.03.2.07.2.92 0 .89 0 .89-4.16.9-2.29.01-4.24-.01-4.34-.03zm.012-2.408c-.103-.266-.07-5.734.037-5.93.092-.174.235-.18 4.01-.18 4.454 0 3.983.104 4.036-.886.05-.998.4-.633.4.42 0 .887 0 .887-3.97.932-3.96.045-3.96.045-4.01 2.892-.04 2.813-.05 2.847-.24 2.873-.11.01-.22-.04-.25-.13zm-20.085-.954c-.185-.346-.56-1.03-.84-1.516-.276-.487-.623-1.116-.77-1.4-.144-.28-.377-.69-.515-.906-.137-.217-.25-.428-.25-.47 0-.043-.133-.284-.297-.538-.39-.616-.84-1.54-.79-1.6.09-.082.25.07.25.225 0 .08.1.28.23.44.13.16.36.56.52.89.16.32.34.65.41.74.07.08.31.48.53.89.67 1.25.79 1.47 1.2 2.16.22.37.39.72.39.78 0 .06.11.23.24.38.24.28.31.54.14.54-.05 0-.24-.29-.42-.63zM.477 8.468C.413 8.405.36 8.3.36 8.235s-.083-.164-.186-.22C-.01 7.92-.013 7.84.01 3.975.035.035.035.035 3.326.013 7.124-.015 6.938-.05 7.844.9c.665.697.656.63.62 4.6-.03 3.032-.03 3.032-.915 3.032-.85 0-.89-.01-.92-.21-.02-.116-.11-.254-.21-.306-.17-.093-.18-.25-.21-2.92-.03-2.82-.03-2.82-1.99-2.82s-1.96 0-2.01 3.13c-.05 3.124-.05 3.124-.84 3.15-.54.017-.84-.01-.91-.09zm10.165-.01c-.428-.137-1.312-.963-1.52-1.42-.15-.334-.17-.662-.17-3.035 0-4.084-.127-3.953 3.9-3.994 3.112-.04 3.113-.04 3.963.88.623.67.618.64.623 3.56.006 4.07-.052 4.13-4.103 4.11-1.414-.01-2.508-.05-2.694-.11zm4.445-4.244c-.023-1.937-.023-1.937-1.936-1.937-1.91 0-1.91 0-1.94 1.817-.01 1 0 1.87.03 1.937.04.1.49.12 1.97.12 1.92 0 1.92 0 1.9-1.93z"/><path fill="#0d150a" d="M5.747 20.863c-.08-.21.017-.246.69-.246.723 0 .846-.08 1.124-.728.1-.23.26-.53.35-.66.1-.14.36-.59.57-1 .42-.78.69-1.29 1.45-2.71.25-.46.49-.89.53-.94.08-.1.2-.33 1.11-2.05.52-.99.76-1.35.88-1.37.14-.02.38.02.42.05.03.02-.37.79-1.2 2.29-.27.48-.65 1.2-.86 1.58-.2.38-.45.83-.55.99-.1.16-.3.52-.44.79-.7 1.33-1.17 2.19-1.27 2.31-.06.075-.14.234-.18.35-.34 1.127-2.29 2.095-2.6 1.295zm8.15-.05c0-.168.07-.192.63-.216.63-.03.63-.03.654-3.458.03-2.93.05-3.44.16-3.44.31 0 .34.34.31 3.8-.02 3.43-.02 3.43-.89 3.46-.81.02-.86.01-.86-.16zm7.862.067c-.22-.214-.12-.256.65-.285.77-.03.77-.03.81-4.694.04-4.59.05-4.66.23-4.66s.18.06.18 4.85c0 4.85 0 4.85-.89 4.88-.61.02-.93-.01-1.01-.09zm3.82-.076c-.17-.104-.31-.2-.31-.212 0-.013 1.94-.027 4.31-.027 4.31 0 4.31 0 4.36-.61.08-1.042.42-.89.42.186 0 .8 0 .8-4.25.82-4.1.03-4.26.02-4.55-.16zm.39-2.26c-.03-.07-.04-1.426-.03-3.02.02-2.894.02-2.894 3.99-2.94 3.97-.047 3.97-.047 4.01-.7.07-1.035.4-.974.44.076.04 1.085.41.995-4.1.995-3.91 0-3.91 0-3.94 2.82-.02 2.804-.12 3.482-.4 2.76zM.45 8.252c0-.226.027-.236.55-.236.79 0 .75.153.78-3.228.027-2.98.027-2.98 2.2-3.004 1.94-.022 2.18-.008 2.24.126.103.273-.18.318-2.094.318-1.89.002-1.89.002-1.913 3.106-.02 3.104-.02 3.104-.885 3.13-.863.03-.863.03-.863-.21zm6.257.002c0-.22.03-.23.63-.257.63-.028.63-.028.63-3.456 0-3.3 0-3.42.16-3.25.29.3.54 6.39.29 7.06-.11.29-1.72.21-1.72-.08zm3.75.045c-.67-.31-.49-.33 2.423-.33 4.085 0 4.02.05 4.066-3.76.016-1.41-.01-2.59-.063-2.78-.1-.37-.03-.42.21-.16.246.27.336 1.12.336 3.18 0 2.87-.18 3.45-1.19 3.88-.53.22-5.28.18-5.79-.06zm.3-2.17c-.03-.07-.04-1.07-.02-2.23.02-2.1.02-2.1 2.13-2.13 1.836-.02 2.125-.01 2.23.12.227.27-.08.31-2.03.32-1.89 0-1.89 0-1.915 1.98-.027 1.94-.154 2.56-.403 1.92z"/></svg>
EOF
}
